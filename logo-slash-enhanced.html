<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ゼゼヒヒ - 超強化版 斬撃ロゴアニメーション</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght=900&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
            font-family: 'Zen Kaku Gothic New', sans-serif;
        }

        .logo-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #logoSVG {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.3));
        }

        /* SVG内のテキストスタイル */
        .logo-text {
            font-family: 'Zen Kaku Gothic New', sans-serif;
            font-weight: 900;
            font-size: 120px;
            fill: #ffffff;
            user-select: none;
        }

        /* 斬撃エフェクト関連 */
        .slash-blade {
            filter: drop-shadow(0 0 15px rgba(255, 255, 255, 1))
                    drop-shadow(0 0 30px rgba(135, 206, 235, 0.8))
                    drop-shadow(0 0 45px rgba(0, 191, 255, 0.6));
        }

        .slash-trail {
            filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.9))
                    drop-shadow(0 0 40px rgba(255, 255, 255, 0.7));
        }

        /* インストラクション */
        .instruction {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-family: sans-serif;
            z-index: 100;
            animation: fadeInOut 8s ease-in-out infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* デバッグ情報（オプション） */
        .debug-info {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            font-family: monospace;
            display: none; /* 必要に応じてblockに変更 */
        }
    </style>
</head>
<body>
    <div class="instruction">
        クリックでアニメーション再生 | 自動ループ
    </div>

    <div class="logo-container">
        <svg id="logoSVG" viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
            <!-- ====================================== -->
            <!-- 定義：フィルター、グラデーション、クリップパス -->
            <!-- ====================================== -->
            <defs>
                <!-- 発光フィルター（強烈なブルーム効果） -->
                <filter id="glow-intense">
                    <feGaussianBlur stdDeviation="8" result="coloredBlur" />
                    <feMerge>
                        <feMergeNode in="coloredBlur" />
                        <feMergeNode in="coloredBlur" />
                        <feMergeNode in="SourceGraphic" />
                    </feMerge>
                </filter>

                <!-- 衝撃波用の放射状グラデーション -->
                <radialGradient id="shockwaveGradient">
                    <stop offset="0%" stop-color="#ffffff" stop-opacity="0.9" />
                    <stop offset="50%" stop-color="#87CEEB" stop-opacity="0.6" />
                    <stop offset="100%" stop-color="#00BFFF" stop-opacity="0" />
                </radialGradient>

                <!-- 斬撃刃のグラデーション -->
                <linearGradient id="bladeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="#ffffff" stop-opacity="1" />
                    <stop offset="50%" stop-color="#87CEEB" stop-opacity="0.9" />
                    <stop offset="100%" stop-color="#00BFFF" stop-opacity="0.7" />
                </linearGradient>

                <!-- 斜めの切断用クリップパス -->
                <!-- ヒヒ1（1文字目）上半分 -->
                <clipPath id="hihi1TopClip">
                    <polygon points="400,130 600,130 600,200 400,150" />
                </clipPath>

                <!-- ヒヒ1（1文字目）下半分 -->
                <clipPath id="hihi1BottomClip">
                    <polygon points="400,150 600,200 600,380 400,380" />
                </clipPath>

                <!-- ヒヒ2（2文字目）上半分 -->
                <clipPath id="hihi2TopClip">
                    <polygon points="560,130 780,130 780,240 560,190" />
                </clipPath>

                <!-- ヒヒ2（2文字目）下半分 -->
                <clipPath id="hihi2BottomClip">
                    <polygon points="560,190 780,240 780,380 560,380" />
                </clipPath>
            </defs>

            <!-- ====================================== -->
            <!-- ゼゼ部分（アニメーションなし）-->
            <!-- ====================================== -->
            <text class="logo-text" x="50" y="280">ゼ</text>
            <text class="logo-text" x="210" y="280">ゼ</text>

            <!-- ====================================== -->
            <!-- ヒヒ部分 - 完全版（切断前・復元後）-->
            <!-- ====================================== -->
            <g id="hihi1Full">
                <text class="logo-text" x="400" y="280">ヒ</text>
            </g>

            <g id="hihi2Full">
                <text class="logo-text" x="560" y="280">ヒ</text>
            </g>

            <!-- ====================================== -->
            <!-- ヒヒ部分 - 分割版（切断後）-->
            <!-- ====================================== -->

            <!-- ヒヒ1 上半分（重力で落下する部分） -->
            <g id="hihi1Top" clip-path="url(#hihi1TopClip)" opacity="0">
                <text class="logo-text" x="400" y="280">ヒ</text>
            </g>

            <!-- ヒヒ1 下半分（固定されて振動する部分） -->
            <g id="hihi1Bottom" clip-path="url(#hihi1BottomClip)" opacity="0">
                <text class="logo-text" x="400" y="280">ヒ</text>
            </g>

            <!-- ヒヒ2 上半分（重力で落下する部分） -->
            <g id="hihi2Top" clip-path="url(#hihi2TopClip)" opacity="0">
                <text class="logo-text" x="560" y="280">ヒ</text>
            </g>

            <!-- ヒヒ2 下半分（固定されて振動する部分） -->
            <g id="hihi2Bottom" clip-path="url(#hihi2BottomClip)" opacity="0">
                <text class="logo-text" x="560" y="280">ヒ</text>
            </g>

            <!-- ====================================== -->
            <!-- VFX: 斬撃刃（エネルギーブレード）-->
            <!-- ====================================== -->
            <g id="slashBlade" opacity="0">
                <!-- 外側の大きな光のオーラ -->
                <line
                    x1="300" y1="50"
                    x2="750" y2="350"
                    stroke="url(#bladeGradient)"
                    stroke-width="40"
                    stroke-linecap="round"
                    opacity="0.3"
                    class="slash-blade"
                />

                <!-- 中間層の明るい光 -->
                <line
                    x1="300" y1="50"
                    x2="750" y2="350"
                    stroke="#87CEEB"
                    stroke-width="20"
                    stroke-linecap="round"
                    opacity="0.6"
                    class="slash-blade"
                />

                <!-- コアの鋭い白刃 -->
                <line
                    id="slashCore"
                    x1="300" y1="50"
                    x2="750" y2="350"
                    stroke="#FFFFFF"
                    stroke-width="6"
                    stroke-linecap="round"
                    opacity="1"
                    class="slash-blade"
                />
            </g>

            <!-- ====================================== -->
            <!-- VFX: 斬撃の光の軌跡（トレイル）-->
            <!-- ====================================== -->
            <g id="slashTrail" opacity="0">
                <line
                    x1="300" y1="50"
                    x2="750" y2="350"
                    stroke="#FFFFFF"
                    stroke-width="60"
                    stroke-linecap="round"
                    opacity="0.8"
                    class="slash-trail"
                    filter="url(#glow-intense)"
                />
            </g>

            <!-- ====================================== -->
            <!-- VFX: インパクト衝撃波（複数の同心円）-->
            <!-- ====================================== -->
            <g id="impactWaves">
                <!-- 衝撃波リング 1 -->
                <circle
                    class="shockwave"
                    cx="550"
                    cy="200"
                    r="0"
                    fill="none"
                    stroke="url(#shockwaveGradient)"
                    stroke-width="8"
                    opacity="0"
                />

                <!-- 衝撃波リング 2 -->
                <circle
                    class="shockwave"
                    cx="550"
                    cy="200"
                    r="0"
                    fill="none"
                    stroke="url(#shockwaveGradient)"
                    stroke-width="6"
                    opacity="0"
                />

                <!-- 衝撃波リング 3 -->
                <circle
                    class="shockwave"
                    cx="550"
                    cy="200"
                    r="0"
                    fill="none"
                    stroke="url(#shockwaveGradient)"
                    stroke-width="4"
                    opacity="0"
                />

                <!-- 衝撃波リング 4 -->
                <circle
                    class="shockwave"
                    cx="550"
                    cy="200"
                    r="0"
                    fill="none"
                    stroke="url(#shockwaveGradient)"
                    stroke-width="3"
                    opacity="0"
                />
            </g>

            <!-- ====================================== -->
            <!-- VFX: フラッシュエフェクト（画面全体の閃光）-->
            <!-- ====================================== -->
            <rect
                id="flashEffect"
                x="0"
                y="0"
                width="800"
                height="400"
                fill="white"
                opacity="0"
            />

            <!-- ====================================== -->
            <!-- 下部のZEZEHIHIテキスト -->
            <!-- ====================================== -->
            <text
                id="bottomText"
                x="400"
                y="370"
                font-size="32"
                font-weight="600"
                fill="white"
                font-family="'Playfair Display', serif"
                text-anchor="middle"
                letter-spacing="0.2em"
                opacity="0"
            >
                ZEZEHIHI
            </text>
        </svg>
    </div>

    <div class="debug-info" id="debugInfo">
        Animation: Ready
    </div>

    <!-- ====================================== -->
    <!-- GSAP Core ライブラリ -->
    <!-- ====================================== -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <script>
        // ==========================================
        // DOM要素の取得
        // ==========================================
        const hihi1Full = document.getElementById('hihi1Full');
        const hihi2Full = document.getElementById('hihi2Full');
        const hihi1Top = document.getElementById('hihi1Top');
        const hihi1Bottom = document.getElementById('hihi1Bottom');
        const hihi2Top = document.getElementById('hihi2Top');
        const hihi2Bottom = document.getElementById('hihi2Bottom');
        const slashBlade = document.getElementById('slashBlade');
        const slashCore = document.getElementById('slashCore');
        const slashTrail = document.getElementById('slashTrail');
        const impactWaves = document.getElementById('impactWaves');
        const flashEffect = document.getElementById('flashEffect');
        const bottomText = document.getElementById('bottomText');
        const shockwaves = document.querySelectorAll('.shockwave');
        const debugInfo = document.getElementById('debugInfo');

        // ==========================================
        // デバッグ用関数
        // ==========================================
        function debug(message) {
            if (debugInfo) {
                debugInfo.textContent = message;
                console.log(message);
            }
        }

        // ==========================================
        // パフォーマンス最適化設定
        // ==========================================
        gsap.config({
            force3D: true,  // GPU アクセラレーション強制
        });

        // GPU最適化のため、transform-originを設定
        gsap.set([hihi1Top, hihi2Top], {
            transformOrigin: "center center",
            force3D: true,
        });

        gsap.set([hihi1Bottom, hihi2Bottom], {
            transformOrigin: "center center",
            force3D: true,
        });

        // ==========================================
        // メインアニメーション関数
        // ==========================================
        function createSlashAnimation() {
            // マスタータイムライン（無限ループ）
            const masterTL = gsap.timeline({
                repeat: -1,
                repeatDelay: 2.5,
                onStart: () => debug('Animation: Started'),
                onRepeat: () => debug('Animation: Loop')
            });

            // ==========================================
            // フェーズ0: 初期状態とZEZEHIHIテキスト表示
            // ==========================================
            masterTL.to(bottomText, {
                opacity: 1,
                duration: 0.8,
                ease: 'power2.out',
            }, 0);

            // 少し待つ
            masterTL.to({}, { duration: 0.8 });

            // ==========================================
            // フェーズ1: 超高速斬撃（High-Speed Slash）
            // ==========================================

            // 斬撃刃が一瞬で出現
            masterTL.to(slashBlade, {
                opacity: 1,
                duration: 0.08,
                ease: 'power4.out',
                onStart: () => debug('Slash: Blade appears!')
            });

            // 斬撃の光の軌跡（少し遅れて出現し、すぐに消える）
            masterTL.to(slashTrail, {
                opacity: 1,
                duration: 0.05,
                ease: 'power4.out',
            }, '-=0.04');

            masterTL.to(slashTrail, {
                opacity: 0,
                duration: 0.15,
                ease: 'power2.out',
            }, '+=0.05');

            // ==========================================
            // フェーズ2: インパクトの瞬間（Impact Moment）
            // ==========================================

            // 画面全体の閃光（一瞬だけ）
            masterTL.to(flashEffect, {
                opacity: 0.4,
                duration: 0.05,
                ease: 'power4.out',
                onStart: () => debug('Impact: FLASH!')
            }, '-=0.1');

            masterTL.to(flashEffect, {
                opacity: 0,
                duration: 0.2,
                ease: 'power2.out',
            });

            // 衝撃波が爆発的に広がる
            masterTL.to(shockwaves, {
                r: (i) => 80 + (i * 40),  // 各波が異なる半径に拡大
                opacity: 0.9,
                duration: 0.4,
                stagger: 0.08,
                ease: 'power2.out',
                onStart: () => debug('Impact: Shockwave expanding!')
            }, '-=0.25');

            // 衝撃波がフェードアウト
            masterTL.to(shockwaves, {
                opacity: 0,
                duration: 0.3,
                stagger: 0.08,
                ease: 'power2.in',
            }, '-=0.2');

            // ==========================================
            // フェーズ3: 切断と物理挙動
            // ==========================================

            // 完全版のヒヒを非表示にする
            masterTL.to([hihi1Full, hihi2Full], {
                opacity: 0,
                duration: 0.02,
                onStart: () => debug('Split: Characters split!')
            }, '-=0.35');

            // 分割版を表示
            masterTL.to([hihi1Top, hihi1Bottom, hihi2Top, hihi2Bottom], {
                opacity: 1,
                duration: 0.02,
            }, '-=0.02');

            // ----------------------------------------------
            // 【下半分】激しい振動（その場で固定）
            // ----------------------------------------------
            const vibrationTL = gsap.timeline();

            // 衝撃による激しい振動（弾性振動）
            vibrationTL.to([hihi1Bottom, hihi2Bottom], {
                x: 3,
                y: -2,
                duration: 0.04,
                ease: 'power2.out',
                onStart: () => debug('Bottom: Vibrating!')
            })
            .to([hihi1Bottom, hihi2Bottom], {
                x: -3,
                y: 2,
                duration: 0.04,
                ease: 'power2.inOut',
            })
            .to([hihi1Bottom, hihi2Bottom], {
                x: 2,
                y: -1,
                duration: 0.04,
                ease: 'power2.inOut',
            })
            .to([hihi1Bottom, hihi2Bottom], {
                x: -2,
                y: 1,
                duration: 0.04,
                ease: 'power2.inOut',
            })
            .to([hihi1Bottom, hihi2Bottom], {
                x: 1,
                y: -0.5,
                duration: 0.04,
                ease: 'power2.inOut',
            })
            .to([hihi1Bottom, hihi2Bottom], {
                x: -1,
                y: 0.5,
                duration: 0.04,
                ease: 'power2.inOut',
            })
            .to([hihi1Bottom, hihi2Bottom], {
                x: 0,
                y: 0,
                duration: 0.08,
                ease: 'elastic.out(2, 0.3)',
            });

            masterTL.add(vibrationTL, '-=0.33');

            // ----------------------------------------------
            // 【上半分】重力による落下（回転しながら）
            // ----------------------------------------------
            masterTL.to([hihi1Top, hihi2Top], {
                y: 60,           // 下にズレ落ちる
                x: 15,           // 斜めにズレる
                rotation: 8,     // 時計回りに少し回転
                opacity: 0.8,    // 少し薄くなる
                duration: 0.8,
                ease: 'power2.in',  // 重力加速
                onStart: () => debug('Top: Falling with gravity!')
            }, '-=0.33');

            // ==========================================
            // フェーズ4: 待機時間
            // ==========================================
            masterTL.to({}, { duration: 1.2 });

            // ==========================================
            // フェーズ5: 復元（Restore）
            // ==========================================

            // 上半分が磁力で吸い寄せられるように元に戻る
            masterTL.to([hihi1Top, hihi2Top], {
                y: 0,
                x: 0,
                rotation: 0,
                opacity: 1,
                duration: 0.9,
                ease: 'back.out(1.7)',
                onStart: () => debug('Restore: Magnetic pull!')
            });

            // 下半分も完全に静止
            masterTL.to([hihi1Bottom, hihi2Bottom], {
                x: 0,
                y: 0,
                duration: 0.9,
                ease: 'back.out(1.7)',
            }, '-=0.9');

            // 分割版を非表示
            masterTL.to([hihi1Top, hihi1Bottom, hihi2Top, hihi2Bottom], {
                opacity: 0,
                duration: 0.2,
                onStart: () => debug('Restore: Merging parts...')
            }, '-=0.2');

            // 完全版を再表示
            masterTL.to([hihi1Full, hihi2Full], {
                opacity: 1,
                duration: 0.2,
            }, '-=0.2');

            // 斬撃エフェクトをリセット
            masterTL.to(slashBlade, {
                opacity: 0,
                duration: 0.3,
                ease: 'power2.out',
            }, '-=1.5');

            // 衝撃波をリセット
            masterTL.set(shockwaves, {
                r: 0,
                opacity: 0,
            });

            return masterTL;
        }

        // ==========================================
        // アニメーション実行
        // ==========================================
        let mainAnimation;

        // ページロード時に自動開始
        window.addEventListener('load', () => {
            setTimeout(() => {
                mainAnimation = createSlashAnimation();
                mainAnimation.play();
                debug('Animation: Auto-started');
            }, 500);
        });

        // クリックで手動再生
        document.querySelector('.logo-container').addEventListener('click', () => {
            if (mainAnimation) {
                mainAnimation.restart();
                debug('Animation: Manual restart');
            }
        });

        // ==========================================
        // レスポンシブ対応
        // ==========================================
        window.addEventListener('resize', () => {
            debug('Window: Resized');
        });
    </script>
</body>
</html>